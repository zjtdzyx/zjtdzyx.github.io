
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{O as M,d as I,r as w,D as F,z as H,E as m,o as C,k as P,e as l,w as r,b as c,f as a,G as i,H as q,h as x,I as s,J as v,g as b,K as $,L as f,M as k,m as B,x as h}from"./index-B_i3AGOe.js";async function z(p){return(await M.post("/materials",p)).data}async function L(){return(await M.get("/materials")).data}async function S(p,d){return(await M.put(`/materials/${p}`,d)).data}async function T(p){return(await M.delete(`/materials/${p}`)).data}const O={class:"container"},j={class:"search-container"},D={class:"table-container"},G={key:0,class:"edit-container"},J=I({__name:"material_info_query",setup(p){const d=w([]),V=w(""),U=F(()=>{const o=V.value.trim().toLowerCase();return o?d.value.filter(e=>Object.values(e).some(t=>String(t).toLowerCase().includes(o))):d.value}),n=w({materialNumber:"",name:"",unit:"",costPrice:"",sellingPrice:""}),u=w(null);H(async()=>{try{const o=await L();d.value=o,m.success("Material info loaded successfully")}catch{m.error("Failed to load material info")}});async function g(){try{const o=await z(n.value);d.value.push(o),n.value={materialNumber:"",name:"",unit:"",costPrice:"",sellingPrice:""},m.success("Material added successfully")}catch{m.error("Failed to add material")}}function E(o){u.value={...o}}async function N(){try{const o=await S(u.value.materialNumber,u.value),e=d.value.findIndex(t=>{var y;return t.materialNumber===((y=u.value)==null?void 0:y.materialNumber)});e!==-1&&(d.value[e]=o,u.value=null,m.success("Material updated successfully"))}catch{m.error("Failed to update material")}}async function _(o){try{await T(o),d.value=d.value.filter(e=>e.materialNumber!==o),m.success("Material removed successfully")}catch{m.error("Failed to remove material")}}return(o,e)=>(C(),P("div",O,[l(a(k),{class:"box-card"},{default:r(()=>[e[15]||(e[15]=c("div",{class:"card-header"},[c("h1",null,"物资信息管理")],-1)),c("div",j,[l(a(i),{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=t=>V.value=t),placeholder:"输入关键词搜索物资...",clearable:""},null,8,["modelValue"])]),l(a(q),{"label-width":"120px",onSubmit:x(g,["prevent"])},{default:r(()=>[l(a(s),{label:"物资编号"},{default:r(()=>[l(a(i),{modelValue:n.value.materialNumber,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.materialNumber=t),placeholder:"物资编号",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{label:"名称"},{default:r(()=>[l(a(i),{modelValue:n.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.name=t),placeholder:"名称",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{label:"单位"},{default:r(()=>[l(a(i),{modelValue:n.value.unit,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.unit=t),placeholder:"单位",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{label:"成本价"},{default:r(()=>[l(a(i),{modelValue:n.value.costPrice,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.costPrice=t),placeholder:"成本价",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{label:"售价"},{default:r(()=>[l(a(i),{modelValue:n.value.sellingPrice,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.sellingPrice=t),placeholder:"售价",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{class:"form-actions"},{default:r(()=>[l(a(v),{type:"primary",onClick:g},{default:r(()=>e[12]||(e[12]=[b(" 添加物资 ")])),_:1})]),_:1})]),_:1}),c("div",D,[l(a($),{data:U.value,style:{width:"auto",margin:"0 auto"},height:"400",border:""},{default:r(()=>[l(a(f),{prop:"materialNumber",label:"物资编号",width:"150"}),l(a(f),{prop:"name",label:"名称",width:"150"}),l(a(f),{prop:"unit",label:"单位",width:"150"}),l(a(f),{prop:"costPrice",label:"成本价",width:"150"}),l(a(f),{prop:"sellingPrice",label:"售价",width:"150"}),l(a(f),{label:"操作",width:"150"},{default:r(t=>[l(a(v),{type:"primary",size:"small",onClick:y=>E(t.row)},{default:r(()=>e[13]||(e[13]=[b(" 编辑 ")])),_:2},1032,["onClick"]),l(a(v),{type:"danger",size:"small",onClick:y=>_(t.row.materialNumber)},{default:r(()=>e[14]||(e[14]=[b(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),u.value?(C(),P("div",G,[l(a(k),{class:"box-card"},{default:r(()=>[e[18]||(e[18]=c("div",{class:"card-header"},[c("h2",null,"编辑物资")],-1)),l(a(q),{"label-width":"120px",onSubmit:x(N,["prevent"])},{default:r(()=>[l(a(s),{label:"物资编号"},{default:r(()=>[l(a(i),{modelValue:u.value.materialNumber,"onUpdate:modelValue":e[6]||(e[6]=t=>u.value.materialNumber=t),placeholder:"物资编号",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{label:"名称"},{default:r(()=>[l(a(i),{modelValue:u.value.name,"onUpdate:modelValue":e[7]||(e[7]=t=>u.value.name=t),placeholder:"名称",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{label:"单位"},{default:r(()=>[l(a(i),{modelValue:u.value.unit,"onUpdate:modelValue":e[8]||(e[8]=t=>u.value.unit=t),placeholder:"单位",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{label:"成本价"},{default:r(()=>[l(a(i),{modelValue:u.value.costPrice,"onUpdate:modelValue":e[9]||(e[9]=t=>u.value.costPrice=t),placeholder:"成本价",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{label:"售价"},{default:r(()=>[l(a(i),{modelValue:u.value.sellingPrice,"onUpdate:modelValue":e[10]||(e[10]=t=>u.value.sellingPrice=t),placeholder:"售价",required:""},null,8,["modelValue"])]),_:1}),l(a(s),{class:"form-actions"},{default:r(()=>[l(a(v),{type:"primary",onClick:N},{default:r(()=>e[16]||(e[16]=[b(" 更新物资 ")])),_:1}),l(a(v),{onClick:e[11]||(e[11]=t=>u.value=null)},{default:r(()=>e[17]||(e[17]=[b(" 取消 ")])),_:1})]),_:1})]),_:1})]),_:1})])):B("",!0)]))}}),Q=h(J,[["__scopeId","data-v-019fb2f1"]]);export{Q as default};
